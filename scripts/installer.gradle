apply plugin: 'com.ullink.msbuild'

msbuild {
  solutionFile 'WPILibInstaller.sln'

  targets = ['Clean', 'Rebuild']

  parameters.configuration = 'release'
}

ext.installerFile = file('WPILibInstaller/bin/Release/Merged/WPILibInstaller.exe')
def permissionSetter = file('ElevatedPermissionSetter/bin/Release/ElevatedPermissionSetter.exe')


ext.msBuildSetupMain = { Zip zip->
  zip.dependsOn msbuild
  zip.inputs.file installerFile

  zip.from (installerFile)
}

ext.msBuildSetupMain = { Zip zip->
  zip.dependsOn msbuild
  zip.inputs.file installerFile

  zip.from (installerFile)
}

ext.msBuildSetupPermissionsWriter = { Zip zip->
  zip.dependsOn msbuild
  zip.inputs.file permissionSetter

  zip.from (permissionSetter) {
    into '/installUtils'
  }
}
